---
title: "p8105_mtp_tt2714"
author: "Tiffany Tu"    
date: "10/18/2018"
output: github_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(rvest)
library(ggplot2)
library(RColorBrewer)
library(wesanderson)
library(ggrepel)
library(kableExtra)
library(gridExtra)
```

```{r}
```

```{r}
data = read_csv(file = "data/p8105_mtp_data.csv") 

clean_data = data %>% 
  gather(variable, value, -(week:day)) %>% 
  unite(temp, day) %>% 
  spread(temp, value) %>% 
  select(week, activity = variable, Monday, Tuesday, Wednesday, 
         Thursday, Friday, Saturday, Sunday) %>% 
  mutate(activity = str_replace(activity, "activity\\.", "")) %>% 
  rename(time = activity)
kable(head(clean_data))
```

This dataset observes `r length(unique(clean_data$week))` weeks of recorded physical activity. 

--------------------------------------------

1. week vs activity and hour vs activity (mean)
```{r}
total_activity_day = clean_data %>% 
  group_by(week) %>% 
  select(-time) %>% 
  summarise_all(funs(sum)) %>% 
  gather('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday', key = "day", value = "activity") %>% 
  mutate(day = forcats::fct_relevel(day, c('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'))) 

activity_by_day = total_activity_day %>%
  group_by(day) %>% summarise_at(vars(activity), mean) %>% mutate(activity, activity = round(activity))

g1 = ggplot(activity_by_day, aes(x = day, y = activity, group = 1, color = "red")) + geom_point() + geom_line() + geom_text_repel(aes(label = activity), size = 2.8, color = "black") + theme_bw() + labs(title = "Average activity in a week", x = "Day of Week", y = "Activity (per Minute)") + theme(legend.position = "none")
```

```{r minutes vs activity}
activity_by_hour = clean_data %>% 
  group_by(time) %>% 
  select(-week) %>%
  summarise_all(funs(sum)) %>% 
  gather('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday', key = "day", value = "activity") %>% 
  mutate(day = forcats::fct_relevel(day, c('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'))) %>% 
  mutate(time = as.integer(as.character(time)))

timeHMS_formatter <- function(x) {h <- floor(x/60)}

g2 = ggplot(activity_by_hour, aes(x = time, y = activity, color = day)) + geom_smooth(method = "auto") + scale_x_continuous(label = timeHMS_formatter, breaks = seq(1, 1440, by = 64)) + labs(title = "Activity distribution over 24 hour period", x = "Hour of the day", y = "Activity (per Minute)") + theme_bw()
```

```{r combine 2 plots}
grid.arrange(g1, g2)
```

